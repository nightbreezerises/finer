Namespace(mode='identify', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/pokemon_all.yml', num_per_category='3')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'pokemon', 'num_classes': 10, 'num_base': 5, 'num_novel': 5, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'chaos', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/pokemon', 'expt_dir': './experiments/pokemon', 'expt_dir_describe': './experiments/pokemon/describe', 'path_vqa_questions': './experiments/pokemon/describe/pokemon_vqa_questions', 'path_vqa_answers': './experiments/pokemon/describe/pokemon_attributes_pairs', 'path_llm_prompts': './experiments/pokemon/describe/pokemon_llm_prompts', 'expt_dir_guess': './experiments/pokemon/guess', 'path_llm_replies_raw': './experiments/pokemon/guess/pokemon_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/pokemon/guess/pokemon_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/pokemon/guess/pokemon_llm_gussed_names', 'expt_dir_grouping': './experiments/pokemon/grouping'}
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:02<00:10,  2.74s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:05<00:07,  2.48s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:07<00:04,  2.42s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:09<00:02,  2.42s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:11<00:00,  2.29s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:11<00:00,  2.38s/it]
╭───────────────────── Traceback (most recent call last) ──────────────────────╮
│ /home/hdl/project/FineR/FineR_1/discovering.py:305 in <module>               │
│                                                                              │
│   302 │   │   data_discovery = DATA_DISCOVERY[cfg['dataset_name']](cfg, fold │
│   303 │   │                                                                  │
│   304 │   │   # paths to save per-image VQAbot answers (about attributes) an │
│ ❱ 305 │   │   save_path_identify_answers = cfg['path_identify_answers'] + ex │
│   306 │   │                                                                  │
│   307 │   │   # run the main program to describe the per-img attributes      │
│   308 │   │   superclass_results = main_identify(cfg, vqa_bot, data_discover │
╰──────────────────────────────────────────────────────────────────────────────╯
KeyError: 'path_identify_answers'
Namespace(mode='howto', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/pokemon_all.yml', num_per_category='3')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'pokemon', 'num_classes': 10, 'num_base': 5, 'num_novel': 5, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'chaos', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/pokemon', 'expt_dir': './experiments/pokemon', 'expt_dir_describe': './experiments/pokemon/describe', 'path_vqa_questions': './experiments/pokemon/describe/pokemon_vqa_questions', 'path_vqa_answers': './experiments/pokemon/describe/pokemon_attributes_pairs', 'path_llm_prompts': './experiments/pokemon/describe/pokemon_llm_prompts', 'expt_dir_guess': './experiments/pokemon/guess', 'path_llm_replies_raw': './experiments/pokemon/guess/pokemon_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/pokemon/guess/pokemon_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/pokemon/guess/pokemon_llm_gussed_names', 'expt_dir_grouping': './experiments/pokemon/grouping'}
╭───────────────────── Traceback (most recent call last) ──────────────────────╮
│ /home/hdl/project/FineR/FineR_1/discovering.py:324 in <module>               │
│                                                                              │
│   321 │   │   save_path_vqa_questions = cfg['path_vqa_questions']            │
│   322 │   │   llm_bot = LLMBot(model=cfg['model_type_llm'], temperature=0.1) │
│   323 │   │                                                                  │
│ ❱ 324 │   │   superclass = load_json(cfg['path_identify_answers'] + expt_id_ │
│   325 │   │                                                                  │
│   326 │   │   if len(superclass) > 1:                                        │
│   327 │   │   │   prompt = [                                                 │
╰──────────────────────────────────────────────────────────────────────────────╯
KeyError: 'path_identify_answers'
